# JavaScript API and Usage

The siteâ€™s JavaScript is plain jQuery (no bundler) compiled into `assets/js/main.min.js`. It wires up:

- Responsive navigation (Greedy Navigation)
- Sticky footer spacing
- Responsive video embeds (FitVids)
- Smooth scrolling anchor links
- Image lightbox (Magnific Popup)
- Simple collapsible sections

Build commands: `npm run build:js` and `npm run watch:js` (see package.json).

## Files

- `assets/js/_main.js`: Initializes FitVids, smoothScroll, lightbox, sticky footer, and author menu toggle.
- `assets/js/plugins/jquery.greedy-navigation.js`: Greedy Navigation implementation.
- `assets/js/collapse.js`: Minimal collapsible sections handler.
- `assets/js/main.min.js`: Minified bundle generated by the build script.

## Initialization behaviors

### Sticky footer spacing
Automatically sets body bottom margin to match `.page__footer` height, updating on window resize.

Usage: include the standard layout with footer. No extra setup needed.

### FitVids (responsive video)
Applies to embedded videos automatically when the page loads.

Example:
```html
<div class="video">
  <iframe src="https://www.youtube.com/embed/XXXXXXXX" frameborder="0" allowfullscreen></iframe>
</div>
```

### Smooth scroll
All anchor links (`<a>`) get smooth scrolling with an offset of 65px to account for the fixed masthead.

Example:
```html
<a href="#section-1">Jump to section 1</a>
...
<h2 id="section-1">Section 1</h2>
```

### Image lightbox (Magnific Popup)
All anchors ending with `.jpg/.jpeg/.png/.gif` are auto-enhanced with a gallery lightbox and zoom-in animation.

Example:
```html
<a href="/images/photo.jpg">
  <img src="/images/photo-thumb.jpg" alt="A photo" />
</a>
```

## Greedy Navigation
File: `assets/js/plugins/jquery.greedy-navigation.js`

This script moves overflowing menu items from `.visible-links` into `.hidden-links` and toggles a dropdown button. It recalculates on `resize` and `screen.orientation` changes.

Required markup:
```html
<nav id="site-nav" class="greedy-nav">
  <button><div class="navicon"></div></button>
  <ul class="visible-links">
    <li class="masthead__menu-item masthead__menu-item--lg"><a href="/">Site Title</a></li>
    <li class="masthead__menu-item"><a href="/publications/">Publications</a></li>
    <!-- more links -->
  </ul>
  <ul class="hidden-links hidden"></ul>
</nav>
```

Customization notes:
- Ensure the structure and IDs/classes match the example.
- The script assigns a `count` attribute to the button reflecting overflow.

## Collapsible sections
File: `assets/js/collapse.js`

Clicking an element with class `.header` toggles visibility of its immediate next sibling with a slide animation.

Example:
```html
<div class="header">Expand</div>
<div class="content" style="display:none;">
  <p>Hidden content revealed on click.</p>
</div>
```

## Build scripts
- `npm run build:js`: Minifies and concatenates vendor and local JS into `assets/js/main.min.js`.
- `npm run watch:js`: Rebuilds when files under `assets/js/**` change (excluding the minified output).

Dependencies (installed via `npm i`): `jquery`, `fitvids`, `jquery-smooth-scroll`, `magnific-popup`, `uglify-js`, `onchange`.
